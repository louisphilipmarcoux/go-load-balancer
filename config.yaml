listenAddr: ":8443"
metricsAddr: ":9090"

tls:
  certFile: "server.crt"
  keyFile: "server.key"

rateLimit:
  enabled: true
  requestsPerSecond: 10
  burst: 20

# NEW: Add circuit breaker config
circuitBreaker:
  enabled: true
  # Trip after 5 consecutive failures
  consecutiveFailures: 5
  # After tripping, stay "OPEN" for 15 seconds
  openStateTimeout: "15s"

routes:
  - path: "/api/"
    strategy: "round-robin"
    backends:
      - addr: "localhost:9001"
        weight: 1
  - path: "/"
    strategy: "weighted-least-connections"
    backends:
      - addr: "localhost:9002"
        weight: 5
      - addr: "localhost:9003"
        weight: 1
